<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire de Commande</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            max-width: 500px;
        }
        h1 {
            text-align: center;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 8px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        input[type="submit"], button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        input[type="submit"]:hover, button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>

    <h1>LTD GROOVE STREET COMMANDE</h1>
    <form id="orderForm">
        <label for="nom_entreprise">Nom de l'entreprise :</label>
        <select id="nom_entreprise" name="nom_entreprise" required>
            <option value="">--Sélectionnez--</option>
            <option value="Custom Motor">Custom Motor</option>
            <option value="Docktease">Docktease</option>
            <option value="Pearls">Pearls</option>
            <option value="Ls-custom">Ls-custom</option>
            <option value="test">test</option>
        </select>

        <div id="articles">
            <div class="article">
                <label for="type_article_0">Article :</label>
                <select id="type_article_0" name="type_article[]" required>
                    <option value="">--Sélectionnez--</option>
                    <option value="Bagel">Bagel</option>
                    <option value="Bar de chocolat">Bar de chocolat</option>
                    <option value="caramel">Caramel</option>
                    <option value="Colle">Colle</option>
                </select>
                
                <label for="quantite_0">Quantité :</label>
                <input type="number" id="quantite_0" name="quantite[]" required min="1">
            </div>
        </div>

        <button type="button" onclick="addArticle()">Ajouter un autre article</button>
        <input type="submit" value="Commander">
    </form>

    <script>
        let articleCount = 1;

        function addArticle() {
            const articlesDiv = document.getElementById('articles');
            const newArticle = document.createElement('div');
            newArticle.classList.add('article');
            newArticle.innerHTML = `
                <label for="type_article_${articleCount}">Type d'article :</label>
                <select id="type_article_${articleCount}" name="type_article[]" required>
                    <option value="">--Sélectionnez--</option>
                    <option value="Bagel">Bagel</option>
                    <option value="Bar de chocolat">Bar de chocolat</option>
                    <option value="caramel">Caramel</option>
                    <option value="Colle">Colle</option>
                </select>
                
                <label for="quantite_${articleCount}">Quantité :</label>
                <input type="number" id="quantite_${articleCount}" name="quantite[]" required min="1">
            `;
            articlesDiv.appendChild(newArticle);
            articleCount++;
        }

        document.getElementById('orderForm').addEventListener('submit', function(event) {
            event.preventDefault();

            // Récupération des données du formulaire
            const formData = new FormData(this);
            const data = {};
            formData.forEach((value, key) => {
                if (!data[key]) {
                    data[key] = value;
                } else {
                    if (!Array.isArray(data[key])) {
                        data[key] = [data[key]];
                    }
                    data[key].push(value);
                }
            });

            // Génération du message pour Discord
            let messageContent = `**Nouvelle commande reçue**\nEntreprise : ${data.nom_entreprise}\n\n**Articles commandés :**\n`;
            for (let i = 0; i < data['type_article[]'].length; i++) {
                messageContent += `- ${data['type_article[]'][i]} : ${data['quantite[]'][i]}\n`;
            }

            // Envoi des données au webhook Discord
            const webhookURL = "https://discord.com/api/webhooks/1302484491750608917/WNvQpFSP14CA5gSeHHHmy67BgiBOVQ5or5yn71Yds5z8jXGIB_Oj3RSw5j5xur8IZbzn"; // Remplace cette URL avec ton webhook Discord
            fetch(webhookURL, {
                method: "POST",
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ content: messageContent })
            }).then(response => {
                if (response.ok) {
                    alert("Commande envoyée et résumée sur Discord avec succès !");
                    console.log("Message envoyé sur Discord.");
                } else {
                    alert("Échec de l'envoi de la commande sur Discord.");
                    console.error("Erreur lors de l'envoi du message à Discord : ", response);
                }
            }).catch(error => {
                console.error("Erreur lors de l'envoi du message à Discord : ", error);
                alert("Erreur de connexion au webhook Discord.");
            });
        });
    </script>

</body>
</html>
